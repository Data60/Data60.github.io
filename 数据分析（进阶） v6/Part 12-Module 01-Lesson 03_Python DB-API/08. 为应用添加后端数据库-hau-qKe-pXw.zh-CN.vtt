WEBVTT
Kind: captions
Language: zh-CN

00:00:00.640 --> 00:00:04.707
先讲一种修改这段代码的方法 你们有可能会这样写

00:00:04.707 --> 00:00:08.141
但实际上 这会引入一个很严重的 bug 我们等会儿再分析

00:00:08.141 --> 00:00:12.350
所以先别急着把它们复制到你们的应用里

00:00:12.350 --> 00:00:17.040
每当我们想要向数据库进行读写操作时就先要连接它

00:00:18.200 --> 00:00:19.340
然后创建一个光标 (cursor)

00:00:20.940 --> 00:00:22.160
然后就可以执行

00:00:23.480 --> 00:00:28.740
比如说 GetAllPosts 我们执行一个 select 语句

00:00:30.160 --> 00:00:35.160
接下来我们就获得了所有的结果

00:00:35.160 --> 00:00:39.570
把它们转换成与代码匹配的字典形式

00:00:39.570 --> 00:00:42.110
显然 还要关闭连接并返回帖子

00:00:43.270 --> 00:00:46.760
对于 AddPost 我们同样要连接数据库

00:00:47.850 --> 00:00:49.950
执行一个 insert 语句

00:00:49.950 --> 00:00:55.280
把帖子内容放到数据库字符串 query 中

00:00:55.280 --> 00:00:58.070
提交改动然后关闭连接

00:00:58.070 --> 00:01:02.060
这样似乎是完成任务了 但我刚刚说过 这里有一个很严重的 bug

00:01:02.060 --> 00:01:03.420
让我们马上就来看一看

