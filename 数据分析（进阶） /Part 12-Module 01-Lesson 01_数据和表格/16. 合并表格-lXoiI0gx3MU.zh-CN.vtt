WEBVTT
Kind: captions
Language: zh-CN

00:00:00.340 --> 00:00:03.690
好 现在让我们回到大猩猩和大羊驼所在的动物园

00:00:03.690 --> 00:00:05.280
记得这些表吗？

00:00:05.280 --> 00:00:09.790
在这个表中 有动物的名字、物种和出生日期

00:00:09.790 --> 00:00:13.310
在另一个表中 有物种和它们吃的食物

00:00:13.310 --> 00:00:18.200
假如我们想要知道有多少动物吃鱼

00:00:18.200 --> 00:00:20.760
这是一个关于多少的问题

00:00:20.760 --> 00:00:24.760
因此我们需要用到聚合函数 但是 我们要聚合的是什么？

00:00:24.760 --> 00:00:27.630
动物表里没有食物这一项

00:00:27.630 --> 00:00:30.880
食物表里没有说每个物种有多少动物

00:00:30.880 --> 00:00:34.250
但假如我们可以得到一个表 这个表在动物表基础上

00:00:34.250 --> 00:00:35.780
添加了食物列

00:00:35.780 --> 00:00:38.280
那么我们就可以进行统计了

00:00:38.280 --> 00:00:42.000
我们之前已经学过 通过 join 对这些表进行连接 

00:00:42.000 --> 00:00:44.310
从而得到一个新的结果表

00:00:44.310 --> 00:00:45.896
我们可以得到一个像这样的语句

00:00:45.896 --> 00:00:51.986
Select animals.name, animals.species,

00:00:51.986 --> 00:00:56.825
diet.food from animals join diet,

00:00:56.825 --> 00:01:02.930
on animals.species equals diet.species.

00:01:02.930 --> 00:01:05.670
但我们只想得到吃鱼的动物

00:01:05.670 --> 00:01:08.450
之前我们学过 可以像这样对行进行限制

00:01:08.450 --> 00:01:13.160
让数据库只返回符合特定标准的行

00:01:13.160 --> 00:01:17.250
相同的查询语句 但现在它的结尾是 where food equals fish

00:01:17.250 --> 00:01:21.175
因此 为了回答有多少动物吃鱼这个问题

00:01:21.175 --> 00:01:23.910
我们的查询需要做三件事

00:01:23.910 --> 00:01:29.640
首先 将动物表与饮食表相连接 使用物种进行匹配

00:01:29.640 --> 00:01:31.460
然后进行限制

00:01:31.460 --> 00:01:34.039
只选择食物等于鱼的行

00:01:35.070 --> 00:01:38.230
最后 我们将进行聚合操作 计算行数

00:01:38.230 --> 00:01:42.460
需要考虑的是 这些表中每个表会有多少行？

00:01:42.460 --> 00:01:46.810
正如表彼此关联一样 对行的计数也是如此

00:01:46.810 --> 00:01:50.440
假设动物园里有100只动物

00:01:50.440 --> 00:01:55.360
我们从查询中得出的最终答案是 其中20只吃鱼

00:01:55.360 --> 00:01:59.330
记住 我们从数据库查询中得到的每个结果都是一个表

00:01:59.330 --> 00:02:02.260
聚合操作的结果也是一样

00:02:02.260 --> 00:02:06.090
计数表只有一行和一列 包含数字20

00:02:06.090 --> 00:02:10.639
那表示以食物是鱼为条件进行筛选的结果

00:02:10.639 --> 00:02:12.310
肯定有20行

00:02:12.310 --> 00:02:16.850
现在 我们实际上并不知道进行连接后有多少行 但它肯定

00:02:16.850 --> 00:02:21.860
至少有100行 因为每个动物至少吃一种食物

00:02:21.860 --> 00:02:25.220
但有些动物不止吃一种食物 比如熊 它吃鱼

00:02:25.220 --> 00:02:26.960
也吃肉和水果

00:02:26.960 --> 00:02:30.380
我们不知道饮食表有多少行 但至少

00:02:30.380 --> 00:02:34.570
跟动物表中物种的数量一样多

00:02:34.570 --> 00:02:37.870
因为每个物种至少吃一种食物

